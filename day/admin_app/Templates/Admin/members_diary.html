{% extends "base/base.html" %}

{% block title %}Members Diary{% endblock title %}
{% load static %}

{% block link %}
<link href="{% static 'css/members_diary.css' %}" rel="stylesheet">
{% endblock link %}

{% block bodyblock %}
<main id="main" class="main">
  <br>
  <div class="pagetitle">
    <h1>Members Diary</h1>

  </div>
  
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add Vertical Role</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
     
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>

  <form method="post" action="{% url 'simple_upload' %}" enctype="multipart/form-data">
    {% csrf_token %}
    
    <label for="fileUpload" class="drop-area">
      <div class="icon-container">
        <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
          <polyline points="14 2 14 8 20 8"/>
          <path d="M8 13h8M8 17h8M8 9h1"/>
        </svg>
      </div>
      <div class="drop-text">Drag & drop your Excel file here</div>
      <div class="drop-hint">or click to browse files</div>
      <div class="file-types">Accepted file types: .xlsx, .xls</div>
      
      <input 
        type="file" 
        name="myfile" 
        id="fileUpload" 
        class="file-input" 
        accept=".xlsx,.xls"
        required
      >
      
      <div class="selected-file">
        File Upload<span id="fileName"></span>
      </div>
    </label>
    <br>
    
    <button type="submit" class="btn btn-primary">Upload File</button>
  </form>

 
  <div class="card mt-4 mb-4">
    <div class="card-header bg-white py-3">
      <div class="card-header bg-white d-flex flex-wrap justify-content-between align-items-center ">
          <h3 style="color:darkblue">Members Diary</h3>
  
          <div class="col-12 col-sm-6 col-md-4 col-lg-4">

          
        </div><form method="GET" action="{% url 'member-diary' %}">
          <div class="d-flex">
              <input type="text" name="search_member" class="form-control me-2" placeholder="Search Member">
              <button type="submit" class="btn btn-primary">Search</button>
          </div>
      </form>
      
          
      </div> 
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover table-striped" id="example">
          <thead>
            <tr class="text-nowrap text-center">
              <th>Sr No</th>
              <th>Name</th>
              <th>First Name</th>
              <th>Last Name</th>
              <th>D.O.B</th>
              <th>Email</th>
              <th>Company Name</th>
              <th>Company Designation</th>
              <th>Address</th>
              <th>EC Member</th>
              <th>EC Designation</th>
              <th>Vertical</th>
              <th>Phone Number</th>
              <th colspan='2'>Social Media</th>
              <th>Profile Image</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for member in demo %}
            <tr class="text-nowrap text-center">
              <td>{{ forloop.counter }}</td>
              <td>{{ member.First_Name}}  {{member.Last_Name}}</td>
              <td>{{ member.First_Name}}</td>
              <td>{{ member.Last_Name}}</td>
              <td>{{ member.DOB }}</td>
              <td>{{ member.Email_Address }}</td>
              <td>{{ member.Company_Name }}</td>
              <td>{{ member.Company_Designation }}</td>
              <td>{{member.Address}}</td>
              <td>{{ member.EC_Member }}</td>
              <td>{{ member.EC_Designation }}</td>
              {% if member.Vertical == '' or member.Vertical == 'nan' or member.Vertical == None %}
              <td> <span class="badge bg-light text-dark">No Vertical</span></td>
              {% else %}
              <td>{{ member.Vertical }}</td>
              {% endif %}
              <td>{{ member.Phone_No }}</td>
              <td><a href="{{member.IG_Link}}" > <i class="bi bi-instagram"></i></a></td>
              <td><a href="{{ member.Linkedin_Link }}" >  <i class="bi bi-linkedin"></i></a></td>
              

              <td>
                <img src="{% if manager.photo %}{{ manager.photo.url }}{% else %}{% static 'Image/img.png' %}{% endif %}" 
                border="1px" height="45px" width="45px" alt="Profile" class="rounded-circle">
              </td>
              <td> <form method="post" action="#" class="d-inline" >
                {% csrf_token %}
                <button class="btn btn-sm btn-outline-danger ms-1" >
                  <i class="bi bi-trash"></i>
                </button>
              </form></td>
            </tr>
            <!-- Edit Modal for each member -->
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</main>
{% endblock %}

{% block script %}
{% comment %} <script>
  // Simple search functionality using built-in JavaScript
  document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('tableSearch');
    
    if (searchInput) {
      searchInput.addEventListener('keyup', function() {
        const searchTerm = this.value.toLowerCase();
        const table = document.getElementById('example');
        const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
        
        for (let i = 0; i < rows.length; i++) {
          const rowText = rows[i].textContent.toLowerCase();
          if (rowText.includes(searchTerm)) {
            rows[i].style.display = '';
          } else {
            rows[i].style.display = 'none';
          }
        }
      });
    }
    
    // Handle file input display
    const fileInput = document.getElementById('fileUpload');
    const fileName = document.getElementById('fileName');
    
    if (fileInput && fileName) {
      fileInput.addEventListener('change', function() {
        if (this.files && this.files[0]) {
          fileName.textContent = this.files[0].name;
        }
      });
    }
  });
</script> {% endcomment %}
{% endblock script %}